<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trader Route – Create Request</title>
  <meta name="description" content="Create a free trade request on Trader Route and connect with importers and exporters worldwide.">
  <link rel="icon" href="assets/logos.png" />
  <style>
    body{font-family:Inter,Segoe UI,Tahoma,Geneva,Verdana,sans-serif;margin:0;background:#f6f8fa;}
    header{display:flex;align-items:center;justify-content:space-between;background:#fff;padding:10px 40px;
           box-shadow:0 2px 8px rgba(0,0,0,.1);position:sticky;top:0;z-index:1000;}
    .logo-container{display:flex;align-items:center;gap:10px;cursor:pointer;}
    .logo-container img{height:45px;}
    .logo-text{font-size:15px;color:#555;font-weight:500;}
    form{max-width:600px;margin:40px auto;background:#fff;padding:30px;border-radius:10px;
         box-shadow:0 2px 10px rgba(0,0,0,.05);}
    h2{text-align:center;color:#008b6a;margin-bottom:25px;}
    label{display:block;font-weight:600;margin-top:10px;margin-bottom:6px;}
    input,textarea,select{width:100%;padding:10px;border:1px solid #ccc;border-radius:6px;font-size:14px;}
    textarea{resize:vertical;min-height:90px;}
    .radio-group{display:flex;gap:15px;margin-top:10px;}
    button{background:#008b6a;color:#fff;border:none;padding:12px 18px;border-radius:6px;
           cursor:pointer;font-weight:600;margin-top:20px;width:100%;transition:.3s;}
    button:hover{background:#006b52;}
    .success-msg{display:none;color:#008b6a;text-align:center;margin-top:15px;font-weight:600;}
  </style>
</head>

<body>
  <!-- ✅ HEADER (orijinal yapısı korunur) -->
  <header>
    <div class="logo-container" onclick="location.href='index.html'">
      <img src="assets/logos.png" alt="Trader Route Logo">
      <span class="logo-text">The Silk Road of E-Commerce</span>
    </div>
  </header>

  <form id="requestForm">
    <h2>Create Trade Request</h2>

    <label for="title">Request Title</label>
    <input type="text" id="title" placeholder="Example: I want to buy banana" required>

    <label for="description">Description</label>
    <textarea id="description" placeholder="Describe your request..." minlength="10" required></textarea>

    <label for="category">Category</label>
    <select id="category" required>
      <option value="">Select Category</option>
      <option value="Food Industry">Food Industry</option>
      <option value="Agriculture Industry">Agriculture Industry</option>
      <option value="Automotive">Automotive</option>
      <option value="Fashion & Apparel">Fashion & Apparel</option>
      <option value="Construction & Building">Construction & Building</option>
      <option value="Medical & Pharmaceutical">Medical & Pharmaceutical</option>
    </select>

    <label for="country">Country</label>
    <select id="country" required>
      <option value="">Select Country</option>
      <option value="Turkey">Turkey</option>
      <option value="United States">United States</option>
      <option value="Germany">Germany</option>
      <option value="France">France</option>
      <option value="Italy">Italy</option>
      <option value="China">China</option>
      <option value="India">India</option>
      <option value="Brazil">Brazil</option>
    </select>

    <label>Type</label>
    <div class="radio-group">
      <label><input type="radio" name="type" value="buy" required> Buy Request</label>
      <label><input type="radio" name="type" value="sell"> Sell Offer</label>
    </div>

    <button type="submit">Submit Request</button>
    <div class="success-msg" id="successMsg">Your request has been created successfully!</div>
  </form>

  <script>
  const form = document.getElementById("requestForm");
  const successMsg = document.getElementById("successMsg");

  form.addEventListener("submit", function(e){
    e.preventDefault();

    const title = document.getElementById("title").value.trim();
    const description = document.getElementById("description").value.trim();
    const category = document.getElementById("category").value;
    const country = document.getElementById("country").value;
    const type = document.querySelector('input[name="type"]:checked').value;

    const currentUser = JSON.parse(localStorage.getItem("tr_user") || "null");
    const requests = JSON.parse(localStorage.getItem("requests") || "[]");

    // ✅ Yeni ilan nesnesi oluştur
    const newRequest = {
      id: Date.now(),
      title,
      description,
      category,
      country,
      type,
      user: currentUser?.email || "Guest",
      date: new Date().toISOString()
    };

    // ✅ Kaydet ve güncelle
    requests.push(newRequest);
    localStorage.setItem("requests", JSON.stringify(requests));

    // ✅ Sayaçları güncellemek için tetikleme
    window.dispatchEvent(new Event("storage"));

    // ✅ Başarılı mesaj ve yönlendirme
    successMsg.style.display = "block";
    form.reset();

    setTimeout(()=>{
      successMsg.style.display = "none";
      location.href = "requests.html"; // yönlendirme eklendi
    },1500);
  });
  </script>
</body>
</html>
