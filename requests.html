<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trader Route – Requests</title>

  <!-- ✅ SEO META -->
  <meta name="description" content="Explore global buy and sell requests on Trader Route. Connect with worldwide buyers and suppliers." />
  <meta name="keywords" content="Trader Route, requests, buy, sell, B2B, global trade, marketplace" />
  <meta name="author" content="Trader Route" />
  <link rel="canonical" href="https://traderroute.com/requests.html" />
  <link rel="icon" href="assets/logos.png" />

  <style>
    :root{--green:#008b6a;--green-dark:#006b52;}
    body{font-family:"Inter",Arial,sans-serif;background:#f6f8fa;margin:0;color:#222;}
    header{display:flex;align-items:center;justify-content:space-between;background:#fff;
            padding:12px 20px;border-bottom:1px solid #ddd;box-shadow:0 2px 4px rgba(0,0,0,0.05);}
    header img{height:50px;cursor:pointer;}
    nav a{margin:0 10px;text-decoration:none;color:#333;font-weight:600;}
    nav a:hover{color:var(--green);}
    .right button{background:var(--green);color:#fff;border:none;border-radius:6px;
                  padding:8px 14px;font-weight:600;cursor:pointer;}
    .right button:hover{background:var(--green-dark);}
    .tabs{display:flex;justify-content:center;background:#fff;border-bottom:1px solid #ddd;
          gap:10px;padding:14px 0;}
    .tabs button{background:none;border:none;font-weight:600;font-size:17px;padding:10px 24px;
                 border-radius:25px;cursor:pointer;color:#333;}
    .tabs button.active{background:var(--green);color:#fff;}
    .container{max-width:1300px;margin:35px auto;display:flex;gap:24px;padding:0 15px;}
    .sidebar{width:300px;background:#fff;padding:22px;border-radius:12px;
             box-shadow:0 2px 6px rgba(0,0,0,0.06);}
    .category-list,.country-list{max-height:250px;overflow-y:auto;list-style:none;padding:0;margin:0;}
    .category-list a,.country-list a{display:flex;justify-content:space-between;
                                    text-decoration:none;color:#333;padding:5px 3px;border-radius:6px;}
    .category-list a:hover,.country-list a:hover{color:var(--green);}
    .flag{width:20px;height:14px;border:1px solid #ccc;border-radius:2px;margin-right:6px;}
    .content{flex:1;background:#fff;border-radius:12px;padding:30px;
             box-shadow:0 2px 6px rgba(0,0,0,0.06);}
    .request-card{border:1px solid #e3e3e3;border-radius:8px;padding:15px;margin-bottom:15px;
                  background:#fff;cursor:pointer;transition:0.25s;}
    .request-card:hover{box-shadow:0 3px 10px rgba(0,0,0,0.08);}
    .msg-btn{background:var(--green);color:#fff;border:none;border-radius:5px;
             padding:6px 10px;font-size:13px;font-weight:600;cursor:pointer;margin-top:6px;}
  </style>
</head>

<body>
  <!-- ✅ HEADER -->
  <header>
    <div class="left">
      <img src="assets/logos.png" alt="Trader Route Logo" onclick="location.href='index.html'" loading="lazy">
    </div>
    <nav>
      <a href="index.html">Home</a>
      <a href="companies.html">Companies</a>
      <a href="requests.html" style="color:var(--green)">Requests</a>
      <a href="contact.html">Contact</a>
      <a href="pricing.html">Pricing</a>
    </nav>
    <div class="right">
      <button onclick="location.href='free-request.html'">Free Request</button>
      <button onclick="location.href='login.html'">Sign In</button>
      <button onclick="location.href='register.html'">Sign Up</button>
    </div>
  </header>

  <!-- ✅ TABS -->
  <div class="tabs">
    <button class="active" id="tabAll">All Requests</button>
    <button id="tabBuy">Buy Requests</button>
    <button id="tabSell">Sell Requests</button>
    <button id="tabFree" onclick="location.href='free-request.html'">Free Request</button>
  </div>

  <!-- ✅ SAYFA İSKELETİ (bozulmadan) -->
  <div class="container">
    <div class="sidebar">
      <h4>Categories</h4>
      <ul id="categoryList" class="category-list"></ul>
      <h4>Countries</h4>
      <ul id="countryList" class="country-list"></ul>
    </div>

    <div class="content">
      <div id="requestItems"></div>
      <button id="showMoreRequests" style="background:var(--green);color:#fff;">Show more requests</button>
    </div>
  </div>

  <script>
    const getRequests = () => JSON.parse(localStorage.getItem("requests") || "[]");
    const requestContainer = document.getElementById("requestItems");
    let visible = 15, activeTab = "all";

    /* ✅ Kategori ve ülkeleri json’dan çek */
    async function loadLists(){
      const [cat,cou]=await Promise.all([
        fetch("data/categories.json").then(r=>r.json()).catch(()=>[]),
        fetch("data/countries.json").then(r=>r.json()).catch(()=>[])
      ]);
      renderCats(cat); renderCountries(cou);
    }

    function renderCats(arr){
      const ul = document.getElementById("categoryList");
      ul.innerHTML = "";
      arr.slice(0,10).forEach(c=>{
        const li=document.createElement("li");
        li.innerHTML=`<a href="#">${c}</a>`;
        li.onclick=()=>{filterCat=c;renderRequests();};
        ul.append(li);
      });
    }

    function renderCountries(arr){
      const ul = document.getElementById("countryList");
      ul.innerHTML="";
      arr.slice(0,10).forEach(c=>{
        const code=(c.code||c.slice(0,2)).toLowerCase();
        const name=c.name||c;
        const li=document.createElement("li");
        li.innerHTML=`<a href="#"><span><img class="flag" loading="lazy" src="https://flagcdn.com/h20/${code}.png"> ${name}</span></a>`;
        li.onclick=()=>{filterCountry=name;renderRequests();};
        ul.append(li);
      });
    }

    /* ✅ İlan kartları – tıklanabilir ve mesaj butonlu */
    function renderRequests(){
      const reqs = getRequests();
      const filtered=reqs.filter(r=>activeTab==="all"||r.type===activeTab);
      requestContainer.innerHTML="";
      filtered.slice(0,visible).forEach(r=>{
        const div=document.createElement("div");
        div.className="request-card";
        div.innerHTML=`
          <h5>${r.title}</h5>
          <p>${r.description||""}</p>
          <small>${r.country} · ${r.category}</small><br>
          <button class="msg-btn" onclick="event.stopPropagation();window.location.href='messages.html?to=${encodeURIComponent(r.ownerEmail)}'">Message</button>
        `;
        div.onclick=()=>window.location.href=`request-detail.html?id=${encodeURIComponent(r.id)}`;
        requestContainer.append(div);
      });
    }

    document.getElementById("showMoreRequests").onclick=()=>{visible+=10;renderRequests();};
    document.getElementById("tabAll").onclick=()=>{activeTab="all";renderRequests();};
    document.getElementById("tabBuy").onclick=()=>{activeTab="buy";renderRequests();};
    document.getElementById("tabSell").onclick=()=>{activeTab="sell";renderRequests();};

    loadLists().then(renderRequests);
  </script>
</body>
</html>
